{"version":3,"sources":["webpack:///./apps/portal/component.js","webpack:///./apps/portal/action.js","webpack:///./apps/portal/reducer.js","webpack:///./apps/portal/img/photo.png"],"names":["C","props","monkeyKing","path","creator","action","option","onInit","component","injections","reduce","load","webapi","getMenu","menu","getProfile","config","profile","getPhoto","require","getMenuChildren","metaAction","gf","toJS","loop","children","ret","forEach","child","push","key","name","topMenuClick","e","onRedirect","goAfterLogout","context","set","undefined","window","open","menuClick","find","o","hit","appName","appParams","current","metaHandlers","reducer","init","state","metaReducer","lenght","defaultMenuItem","firstMenuItem","defaultOpens","isDefault","isExpand","menuDefaultSelectedKeys","menuDefaultOpenKeys","map","defaultContent","sf","setContent","appProps"],"mappings":"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","file":"mk-app-portal.0a6f9b7e.chunk.js","sourcesContent":["import React, { Component } from 'react'\n\nimport { wrapper } from 'mk-meta-engine'\n\nimport appInfo from './index'\n\n@wrapper(appInfo)\nexport default class C extends Component {\n\trender() {\n\t\treturn this.props.monkeyKing({ ...this.props, path: 'root' })\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./apps/portal/component.js","import React from 'react'\nimport { Menu } from 'mk-component'\nimport { action as MetaAction, AppLoader } from 'mk-meta-engine'\nimport config from './config'\n\nclass action {\n    constructor(option) {\n        this.metaAction = option.metaAction\n        this.config = config.current\n        this.webapi = this.config.webapi\n    }\n\n    onInit = ({ component, injections }) => {\n        this.component = component\n        this.injections = injections\n        injections.reduce('init')\n\n        this.load()\n    }\n\n    load = async () => {\n        if (this.webapi.getMenu) {\n            const menu = await this.webapi.getMenu()\n            this.injections.reduce('load', {menu})\n        }\n    } \n\n    getProfile = () => this.config.profile\n\n    getPhoto = () => require('./img/photo.png')\n\n    getMenuChildren = () => {\n        const menu = this.metaAction.gf('data.menu').toJS()\n        const loop = (children) => {\n            const ret = []\n            children.forEach(child => {\n\n                if (!child.children) {\n                    ret.push(<Menu.Item key={child.key}>{child.name}</Menu.Item>)\n                }\n                else {\n                    ret.push(<Menu.SubMenu key={child.key} title={child.name}>{loop(child.children)}</Menu.SubMenu>)\n                }\n            })\n            return ret\n        }\n        return loop(menu)\n    }\n\n    topMenuClick = (e) => {\n        switch (e.key) {\n            case 'logout':\n                if (this.component.props.onRedirect && this.config.goAfterLogout) {\n                    this.metaAction.context.set('user', undefined)\n                    this.component.props.onRedirect(this.config.goAfterLogout)\n                }\n                break;\n            case 'github':\n                window.open('https://www.github.com/ziaochina/mk-app-portal')\n                break;\n            case 'gitter':\n                window.open('https://gitter.im/mk-js/mk-js?utm_source=share-link&utm_medium=link&utm_campaign=share-link')\n                break;\n        }\n    }\n\n\n    menuClick = (e) => {\n\n        const menu = this.metaAction.gf('data.menu').toJS()\n        const find = (children) => {\n            for (let child of children) {\n                if (child.key == e.key) {\n                    return child\n                }\n\n                if (child.children) {\n                    let o = find(child.children)\n                    if (o) return o\n                }\n            }\n        }\n\n        const hit = find(menu)\n        if (hit) {\n            this.injections.reduce('setContent', hit.appName, hit.appParams)\n        }\n    }\n}\n\nexport default function creator(option) {\n    const metaAction = new MetaAction(option),\n        o = new action({ ...option, metaAction }),\n        ret = { ...metaAction, ...o }\n\n    metaAction.config({ metaHandlers: ret })\n\n    return ret\n}\n\n\n\n// WEBPACK FOOTER //\n// ./apps/portal/action.js","import { Map, fromJS } from 'immutable'\nimport { reducer as MetaReducer } from 'mk-meta-engine'\nimport config from './config'\nimport { getInitState } from './data'\n\nclass reducer {\n    constructor(option) {\n        this.metaReducer = option.metaReducer\n        this.config = config.current\n    }\n\n    init = (state, option) => {\n        state = this.metaReducer.init(state, getInitState())\n\n        if (this.config.menu && !this.config.webapi.getMenu) {\n            return this.load(state, { menu: this.config.menu })\n        }\n\n        return state\n    }\n\n    load = (state, { menu }) => {\n        if (!menu || menu.lenght == 0)\n            return state\n\n        var defaultMenuItem, firstMenuItem, defaultOpens = []\n\n        const loop = (children) => {\n            const ret = []\n            children.forEach(child => {\n                if (!child.children) {\n                    if (!firstMenuItem) {\n                        firstMenuItem = child\n                    }\n\n                    if (child.isDefault) {\n                        defaultMenuItem = child\n                    }\n                }\n                else {\n                    if (child.isExpand) {\n                        defaultOpens.push(child)\n                    }\n                    loop(child.children)\n                }\n            })\n            return ret\n        }\n\n        loop(menu)\n\n        defaultMenuItem = defaultMenuItem || firstMenuItem\n\n        const menuDefaultSelectedKeys = fromJS(defaultMenuItem ? [defaultMenuItem.key] : [])\n        const menuDefaultOpenKeys = fromJS(defaultOpens.map(o => o.key))\n        const defaultContent = fromJS(defaultMenuItem ? defaultMenuItem : {})\n\n        state = this.metaReducer.sf(state, 'data.menu', fromJS(menu))\n        state = this.metaReducer.sf(state, 'data.menuDefaultSelectedKeys', menuDefaultSelectedKeys)\n        state = this.metaReducer.sf(state, 'data.menuDefaultOpenKeys', menuDefaultOpenKeys)\n        state = this.metaReducer.sf(state, 'data.content', defaultContent)\n\n        return state\n    }\n\n    setContent = (state, appName, appProps) => {\n        state = this.metaReducer.sf(state, 'data.content.appName', appName)\n        state = this.metaReducer.sf(state, 'data.content.appParams', appProps)\n        return state\n    }\n}\n\nexport default function creator(option) {\n    const metaReducer = new MetaReducer(option),\n        o = new reducer({ ...option, metaReducer })\n\n    return { ...metaReducer, ...o }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./apps/portal/reducer.js","module.exports = __webpack_public_path__ + \"photo.ac003cd4.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./apps/portal/img/photo.png\n// module id = 1588\n// module chunks = 0"],"sourceRoot":""}