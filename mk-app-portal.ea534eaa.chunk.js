webpackJsonp([4],{1576:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i,o=n(2),u=a(o),s=n(54),c=a(s),f=n(5),p=a(f),d=n(10),m=a(d),l=n(7),h=a(l),g=n(8),v=a(g),b=n(0),w=(a(b),n(165)),k=n(583),y=a(k),A=(r=(0,w.wrapper)(y.default))(i=function(e){function t(){return(0,p.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,m.default)(t,[{key:"render",value:function(){return this.props.monkeyKing((0,u.default)({},this.props,{path:"root"}))}}]),t}(b.Component))||i;t.default=A,e.exports=t.default},1577:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=new g.action(e),n=new y((0,o.default)({},e,{metaAction:t})),a=(0,o.default)({},t,n);return t.config({metaHandlers:a}),a}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),u=n(71),s=a(u),c=n(570),f=a(c),p=n(571),d=a(p),m=n(5),l=a(m);t.default=r;var h=n(0),g=(a(h),n(167),n(165)),v=n(166),b=n(24),w=n(569),k=a(w),y=function e(t){var n=this;(0,l.default)(this,e),this.onInit=function(e){var t=e.component,a=e.injections;n.component=t,n.injections=a,a.reduce("init",n.browserRedirect()),n.load(),b.history.listen("mk-app-portal",n.listen)},this.listen=function(e,t,a){var r=n.metaAction.gf("data.content.appName"),i=e;if(!i)return void n.injections.reduce("closeAll");i!=r&&n.setContent("",i,{})},this.componentWillUnmount=function(){b.history.unlisten("mk-app-portal",n.listen)},this.load=(0,d.default)(f.default.mark(function e(){var t,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.config.apps["mk-app-login"]){e.next=5;break}return t={id:1,mobile:"13334445556",nickname:"齐天大圣"},n.metaAction.context.set("currentUser",t),n.metaAction.sf("data.other.currentUser",(0,v.fromJS)(t)),e.abrupt("return");case 5:return e.next=7,n.webapi.portal.init();case 7:a=e.sent,a.user?(n.metaAction.context.set("currentUser",a.user),n.metaAction.sf("data.other.currentUser",(0,v.fromJS)(a.user))):(n.metaAction.context.set("currentUser",void 0),n.component.props.onRedirect&&n.config.goAfterLogout&&n.component.props.onRedirect(n.config.goAfterLogout));case 9:case"end":return e.stop()}},e,n)})),this.getProfile=function(){return n.config.profile},this.getCurrentUser=function(){return n.metaAction.context.get("currentUser")||{}},this.getMenuChildren=function(){var e=n.metaAction.gf("data.menu").toJS();return{_isMeta:!0,value:function e(t){var n=[];return t.forEach(function(t){t.children?n.push({name:t.key,key:t.key,title:t.name,component:"Menu.SubMenu",children:e(t.children)}):n.push({name:t.key,key:t.key,component:"Menu.Item",children:t.name})}),n}(e)}},this.topMenuClick=function(){var e=(0,d.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.key,e.next="logout"===e.t0?3:"github"===e.t0?9:"gitter"===e.t0?11:"mySetting"===e.t0?13:"toggleTabs"===e.t0?17:18;break;case 3:if(!n.component.props.onRedirect||!n.config.goAfterLogout){e.next=8;break}return e.next=6,n.webapi.user.logout();case 6:n.metaAction.context.set("currentUser",void 0),n.component.props.onRedirect(n.config.goAfterLogout);case 8:return e.abrupt("break",18);case 9:return window.open("https://github.com/fengzhike/fengzhike.github.io"),e.abrupt("break",18);case 11:return window.open("https://gitter.im/mk-js/mk-js?utm_source=share-link&utm_medium=link&utm_campaign=share-link"),e.abrupt("break",18);case 13:if(n.config.apps["mk-app-my-setting"]){e.next=15;break}throw"不存在mk-app-my-setting应用，该功能不能使用";case 15:return n.setContent("个人设置","mk-app-my-setting"),e.abrupt("break",18);case 17:n.metaAction.sf("data.isTabsStyle",!n.metaAction.gf("data.isTabsStyle"));case 18:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}(),this.browserRedirect=function(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),n="iphone os"==e.match(/iphone os/i),a="midp"==e.match(/midp/i),r="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),i="ucweb"==e.match(/ucweb/i),o="android"==e.match(/android/i),u="windows ce"==e.match(/windows ce/i),s="windows mobile"==e.match(/windows mobile/i);return!(t||n||a||r||i||o||u||s)},this.menuClick=function(e){!n.browserRedirect()&&n.metaAction.sf("data.isShowMenu",!1);var t=n.metaAction.gf("data.menu").toJS(),a=function t(n){var a=!0,r=!1,i=void 0;try{for(var o,u=(0,s.default)(n);!(a=(o=u.next()).done);a=!0){var c=o.value;if(c.key==e.key)return c;if(c.children){var f=t(c.children);if(f)return f}}}catch(e){r=!0,i=e}finally{try{!a&&u.return&&u.return()}finally{if(r)throw i}}}(t);a&&n.setContent(a.name,a.appName,a.appParams)},this.getMenuSelectKeys=function(){var e=n.metaAction.gf("data.content");if(e){return[n.metaAction.gf("data.menuKeyNameMap").get(e.get("name"))]}},this.tabChange=function(e){var t=n.metaAction.gf("data.openTabs"),a=t.find(function(t){return t.get("name")==e});n.setContent(a.get("name"),a.get("appName"),a.get("appProps"))},this.tabEdit=function(e,t){"remove"==t&&n.injections.reduce("closeContent",e)},this.setContent=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.injections.reduce("setContent",e,t,a)},this.foldMenu=function(){n.metaAction.sf("data.isShowMenu",!n.metaAction.gf("data.isShowMenu")),setTimeout(function(){var e=document.createEvent("HTMLEvents");e.initEvent("resize",!0,!0),window.dispatchEvent(e)},0)},this.metaAction=t.metaAction,this.config=k.default.current,this.webapi=this.config.webapi};e.exports=t.default},1578:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=new f.reducer(e),n=new h((0,o.default)({},e,{metaReducer:t}));return(0,o.default)({},t,n)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=a(i),u=n(5),s=a(u);t.default=r;var c=n(166),f=n(165),p=n(569),d=a(p),m=n(584),l=n(24),h=function e(t){var n=this;(0,s.default)(this,e),this.init=function(e,t){var a=(0,m.getInitState)();return a.data.isShowMenu=t,a.data.isShowToggleTabs=t,e=n.metaReducer.init(e,a),n.config.menu&&!n.config.webapi.getMenu?n.load(e,{menu:n.config.menu}):e},this.load=function(e,t){var a=t.menu;if(!a||0==a.lenght)return e;var r,i,o=[],u={},s={};!function e(t){var n=[];return t.forEach(function(t){u[t.name]=t.key,t.appName&&(s[t.appName]={name:t.name,props:t.appParams||{}}),t.children?(t.isExpand&&o.push(t),e(t.children)):(i||(i=t),t.isDefault&&(r=t))}),n}(a),r=r||i;var f=(0,c.fromJS)(r?[r.key]:[]),p=(0,c.fromJS)(o.map(function(e){return e.key})),d=r||{};e=n.metaReducer.sf(e,"data.menu",(0,c.fromJS)(a)),e=n.metaReducer.sf(e,"data.menuKeyNameMap",(0,c.fromJS)(u)),e=n.metaReducer.sf(e,"data.menuAppNameMap",(0,c.fromJS)(s)),e=n.metaReducer.sf(e,"data.menuSelectedKeys",f),e=n.metaReducer.sf(e,"data.menuDefaultOpenKeys",p);var m=l.history.getChildApp("mk-app-portal");return m?n.setContent(e,"",m,{}):n.setContent(e,d.name,d.appName,d.appProps)},this.setContent=function(e,t,a,r){var i=n.metaReducer.gf(e,"data.content");if(i&&a==i.get("appName"))return e;var o=n.metaReducer.gf(e,"data.menuAppNameMap");t&&a&&o.getIn([a,"name"])!=t&&(o=o.set(a,(0,c.fromJS)({name:t,props:r})),e=n.metaReducer.sf(e,"data.menuAppNameMap",o)),t=o.getIn([a,"name"]),r=o.getIn([a,"props"]);var u=(0,c.fromJS)({name:t,appName:a,appProps:r});e=n.metaReducer.sf(e,"data.content",u);var s=n.metaReducer.gf(e,"data.openTabs")||(0,c.List)(),f=-1!=s.findIndex(function(e){return e.get("name")==t||e.get("appName")==a}),p=n.metaReducer.gf(e,"data.isTabsStyle");return f?p||(s=(0,c.List)().push(u),e=n.metaReducer.sf(e,"data.openTabs",s)):(s=p?s.push(u):(0,c.List)().push(u),e=n.metaReducer.sf(e,"data.openTabs",s)),setTimeout(function(){l.history.pushChildApp("mk-app-portal",u.get("appName"))},0),e},this.closeContent=function(e,t){var a=n.metaReducer.gf(e,"data.openTabs")||(0,c.List)(),r=a.findIndex(function(e){return e.get("name")==t});return a=a.remove(r),e=n.metaReducer.sf(e,"data.openTabs",a),n.metaReducer.sf(e,"data.content",a.get(a.size-1))},this.closeAll=function(e){return e=n.metaReducer.sf(e,"data.openTabs",new c.List),n.metaReducer.sf(e,"data.content",new c.Map)},this.metaReducer=t.metaReducer,this.config=d.default.current};e.exports=t.default}});